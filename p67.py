import numpy as np

def fullwave3(wt):
    """
    ุชุงุจุน ุจุฑุง ุดุจูโุณุงุฒ ุฎุฑูุฌ ฺฉ ฺฉุณูฺฉููุฏูโ ุชูุงูโููุฌ ุณูโูุงุฒ.
    wt: ูุงุฒ ุจุฑ ุญุณุจ ุฑุงุฏุงู (= ุงูฺฏุง ร ุฒูุงู)
    ุฎุฑูุฌ: ุฏุงูููโ ุณฺฏูุงู ฺฉุณู ุดุฏู
    """
    # ุชุจุฏู wt ุจู ุจุงุฒูโ 0 ุชุง 2*pi
    wt = wt % (2 * np.pi)
    
    # ูุญุงุณุจูโ ููุชุงฺ ูุญุธูโุง ุณู ูุงุฒ
    a = np.sin(wt)
    b = np.sin(wt - 2 * np.pi / 3)
    c = np.sin(wt + 2 * np.pi / 3)
    
    # ููุชุงฺ ุฎุฑูุฌ ฺฉุณูฺฉููุฏูโ ุชูุงูโููุฌ
    return max(a, b, c) - min(a, b, c)

def ripple(waveform):
    """
    ุชุงุจุน ุจุฑุง ูุญุงุณุจูโ ุถุฑุจ ุฑูพู ููุฌ ูุฑูุฏ.
    waveform: ุขุฑุงูโุง ุงุฒ ููุงุฏุฑ ููุฌ ฺฉุณู ุดุฏู
    ุฎุฑูุฌ: ููุฏุงุฑ ุถุฑุจ ุฑูพู ุจู ุฏุฑุตุฏ (%)
    """
    # ูุญุงุณุจูโ ููุฏุงุฑ ูุงูฺฏู ููุฌ
    average = np.mean(waveform)

    # ูุญุงุณุจูโ ููุฏุงุฑ RMS ููุฌ
    rms = np.sqrt(np.mean(np.square(waveform)))

    # ูุญุงุณุจูโ ุถุฑุจ ุฑูพู
    return np.sqrt((rms / average) ** 2 - 1) * 100

# ๐ ุงุฌุฑุง ุจุฑูุงููโ ุชุณุช ุจุฑุง ูุญุงุณุจูโ ุถุฑุจ ุฑูพู ุฎุฑูุฌ ฺฉุณูฺฉููุฏูโ ุชูุงูโููุฌ
waveform = np.zeros(128)
for ii in range(128):
    waveform[ii] = fullwave3(ii * np.pi / 64)

# ูุญุงุณุจูโ ุถุฑุจ ุฑูพู
r = ripple(waveform)

# ููุงุด ูุชุฌู
print(f'The ripple is {r:.4f}%.')
